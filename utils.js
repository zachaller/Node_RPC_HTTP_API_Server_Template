/** * @namespace Utils * @description Contains helper functions. */var common = require('./common.js');var utils = (function(){	var nowFunctions = 	{	};		var pubServerFunctions = 	{		makeError: makeError,		modifyNowFunction: modifyNowFunction    };			/** 	 * @description Gets a new error object with proper parameters.	 * @function Utils.makeError 	 * @param {Number} priority The priority level of the error.	 * @param {String} message The error message	 * @param {String} func The function the error happend in.	 * @param {String} file The file the error happend in.	 * @returns {Error} An error object with properly formated json.	 * */	function makeError(priority, message, func, file)	{		return {"TEXT":message, "FUNCTION":func, "FILE":file, "PRIORITY":priority};		//return new Error('{"TEXT":"'+message+'", "FUNCTION":"'+func+'", "FILE":"'+file+'", "PRIORITY":"'+priority+'"}');	}	//TODO: Document this function	function modifyNowFunction(pubServerFunctions, nowFunctions)	{		var newNow = {}		for(var i in nowFunctions)		{			pubServerFunctions[i] = nowFunctions[i];			newNow[i] = function()			{				var self = this;				var args = Array.prototype.slice.call(arguments);									common.session.get(args[0], function(err, sess)				{					var fqnArray = self.fqn.split('.');					self.session = sess;					args.shift();					nowFunctions[fqnArray[fqnArray.length-1]].apply(self, args);				});			};		}		return newNow;	}		return (function()	{		common.everyone.now.utils = modifyNowFunction(pubServerFunctions, nowFunctions);		return pubServerFunctions;	})();})();module.exports = utils;